/*>>> FAXMACHINE <<<*/

var application_base64 = "PGh0bWw+CiAgPGhlYWQ+CiAgICA8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Imh0dHA6Ly93aW5kb3dzOTMubmV0L2Mvc3lzL3NraW5zL3c5My5jc3M/dj0yLjMuOCI+CiAgPC9oZWFkPgogIDxib2R5IHN0eWxlPSJtYXJnaW46IDA7IGZvbnQtc2l6ZTogMTJweCI+CiAgICA8ZGl2IHN0eWxlPSJ3aWR0aDogNDg0cHg7IGhlaWdodDogNjQwcHg7IGJhY2tncm91bmQtY29sb3I6ICNBQUFBQUE7Ij4KICAgICAgPGRpdiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjogI0NDQ0NDQzsiPgogICAgICAgIDxidXR0b24gaWQ9InNhdmUiIHN0eWxlPSJib3JkZXI6IDFweCBpbnNldDsgbWFyZ2luOiAwIj5TQVZFPC9idXR0b24+CiAgICAgICAgPGJ1dHRvbiBpZD0ib3BlbiIgc3R5bGU9ImJvcmRlcjogMXB4IGluc2V0OyBtYXJnaW46IDAiPk9QRU48L2J1dHRvbj4KICAgICAgICA8YnV0dG9uIGlkPSJoZWxwIiBzdHlsZT0iYm9yZGVyOiAxcHggaW5zZXQ7IG1hcmdpbjogMCI+SEVMUDwvYnV0dG9uPgogICAgICAgIDxzcGFuIHN0eWxlPSJjb2xvcjogZ3JheSI+JiMxNjA7JiMxNjA7JiMxNjA7PC9zcGFuPgogICAgICAgIDxidXR0b24gaWQ9InBsYWluIiBzdHlsZT0iYm9yZGVyOiAxcHggaW5zZXQ7IG1hcmdpbjogMCI+UExBSU48L2J1dHRvbj4KICAgICAgICA8YnV0dG9uIGlkPSJ2b2lkIiBzdHlsZT0iYm9yZGVyOiAxcHggaW5zZXQ7IG1hcmdpbjogMCI+VEhFIFZPSUQ8L2J1dHRvbj4KICAgICAgPC9kaXY+CiAgICAgIDxjYW52YXMgd2lkdGg9IjQ4MCIgaGVpZ2h0PSI0ODAiIHN0eWxlPSJ3aWR0aDogNDgwcHg7IGhlaWdodDogNDgwcHg7IGJvcmRlcjogMnB4IGluc2V0OyIgaWQ9InZveGVsc2NyZWVuIj48L2NhbnZhcz4KICAgICAgPGRpdiBzdHlsZT0ib3ZlcmZsb3cteTogYXV0bzsgd2lkdGg6IDQ4MHB4OyBoZWlnaHQ6IDEyNXB4OyBtYXJnaW4tdG9wOiAycHg7IGJvcmRlcjogMnB4IGluc2V0OyI+CiAgICAgICAgPGRpdj4KICAgICAgICAgIDxzcGFuPiBESVNUOiA8L3NwYW4+IDxpbnB1dCB0eXBlPSJyYW5nZSIgbWF4PSI2IiB2YWx1ZT0iMiIgc3RlcD0iMC4xIiBpZD0iZGlzdCIgc3R5bGU9IndpZHRoOiAzNjBweDsgcG9zaXRpb246IGFic29sdXRlOyBsZWZ0OiAxMDBweDsiPgogICAgICAgIDwvZGl2PgogICAgICAgIDxkaXY+CiAgICAgICAgICA8c3Bhbj4gWS1QT1M6IDwvc3Bhbj4gPGlucHV0IHR5cGU9InJhbmdlIiBtYXg9IjE2IiB2YWx1ZT0iMCIgaWQ9Inlwb3MiIHN0eWxlPSJ3aWR0aDogMzYwcHg7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgbGVmdDogMTAwcHg7Ij4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2PjwvZGl2PgogICAgICAgIDxocj48Y2VudGVyPgogICAgICAgIAk8YnV0dG9uIG9uY2xpY2s9InRpbGVfY29sb3IzZD1nZXRDb2xvcignIzAwMDAwMCcpIiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjogIzAwMDAwMCI+JiMxNjA7JiMxNjA7JiMxNjA7JiMxNjA7PC9idXR0b24+CiAgICAgICAgCTxidXR0b24gb25jbGljaz0idGlsZV9jb2xvcjNkPWdldENvbG9yKCcjMDAwMEZGJykiIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiAjMDAwMEZGIj4mIzE2MDsmIzE2MDsmIzE2MDsmIzE2MDs8L2J1dHRvbj4KICAgICAgICAJPGJ1dHRvbiBvbmNsaWNrPSJ0aWxlX2NvbG9yM2Q9Z2V0Q29sb3IoJyMwMEZGMDAnKSIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICMwMEZGMDAiPiYjMTYwOyYjMTYwOyYjMTYwOyYjMTYwOzwvYnV0dG9uPgogICAgICAgIAk8YnV0dG9uIG9uY2xpY2s9InRpbGVfY29sb3IzZD1nZXRDb2xvcignIzAwRkZGRicpIiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjogIzAwRkZGRiI+JiMxNjA7JiMxNjA7JiMxNjA7JiMxNjA7PC9idXR0b24+CiAgICAgICAgCTxidXR0b24gb25jbGljaz0idGlsZV9jb2xvcjNkPWdldENvbG9yKCcjRkYwMDAwJykiIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiAjRkYwMDAwIj4mIzE2MDsmIzE2MDsmIzE2MDsmIzE2MDs8L2J1dHRvbj4KICAgICAgICAJPGJ1dHRvbiBvbmNsaWNrPSJ0aWxlX2NvbG9yM2Q9Z2V0Q29sb3IoJyNGRjAwRkYnKSIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNGRjAwRkYiPiYjMTYwOyYjMTYwOyYjMTYwOyYjMTYwOzwvYnV0dG9uPgogICAgICAgIAk8YnV0dG9uIG9uY2xpY2s9InRpbGVfY29sb3IzZD1nZXRDb2xvcignI0ZGRkYwMCcpIiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjogI0ZGRkYwMCI+JiMxNjA7JiMxNjA7JiMxNjA7JiMxNjA7PC9idXR0b24+CiAgICAgICAgCTxidXR0b24gb25jbGljaz0idGlsZV9jb2xvcjNkPWdldENvbG9yKCcjRkZGRkZGJykiIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiAjRkZGRkZGIj4mIzE2MDsmIzE2MDsmIzE2MDsmIzE2MDs8L2J1dHRvbj4KICAgICAgICAJPGJ1dHRvbiBvbmNsaWNrPSJ0aWxlX2NvbG9yM2Q9Z2V0Q29sb3IoJyMwMDAwODgnKSIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICMwMDAwODgiPiYjMTYwOyYjMTYwOyYjMTYwOyYjMTYwOzwvYnV0dG9uPgogICAgICAgIAk8YnV0dG9uIG9uY2xpY2s9InRpbGVfY29sb3IzZD1nZXRDb2xvcignIzAwODgwMCcpIiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjogIzAwODgwMCI+JiMxNjA7JiMxNjA7JiMxNjA7JiMxNjA7PC9idXR0b24+CiAgICAgICAgCTxidXR0b24gb25jbGljaz0idGlsZV9jb2xvcjNkPWdldENvbG9yKCcjMDA4ODg4JykiIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiAjMDA4ODg4Ij4mIzE2MDsmIzE2MDsmIzE2MDsmIzE2MDs8L2J1dHRvbj4KICAgICAgICAJPGJ1dHRvbiBvbmNsaWNrPSJ0aWxlX2NvbG9yM2Q9Z2V0Q29sb3IoJyM4ODAwMDAnKSIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICM4ODAwMDAiPiYjMTYwOyYjMTYwOyYjMTYwOyYjMTYwOzwvYnV0dG9uPgogICAgICAgIAk8YnV0dG9uIG9uY2xpY2s9InRpbGVfY29sb3IzZD1nZXRDb2xvcignIzg4MDA4OCcpIiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjogIzg4MDA4OCI+JiMxNjA7JiMxNjA7JiMxNjA7JiMxNjA7PC9idXR0b24+CiAgICAgICAgCTxidXR0b24gb25jbGljaz0idGlsZV9jb2xvcjNkPWdldENvbG9yKCcjODg4ODAwJykiIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiAjODg4ODAwIj4mIzE2MDsmIzE2MDsmIzE2MDsmIzE2MDs8L2J1dHRvbj4KICAgICAgICAJPGJ1dHRvbiBvbmNsaWNrPSJ0aWxlX2NvbG9yM2Q9Z2V0Q29sb3IoJyM4ODg4ODgnKSIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICM4ODg4ODgiPiYjMTYwOyYjMTYwOyYjMTYwOyYjMTYwOzwvYnV0dG9uPgogICAgICAgIDwvY2VudGVyPjxocj4KICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KICAgIDxzY3JpcHQgbmFtZT0iZW5naW5lIj4KICAgICAgLyogPj4+IEYgQSBYIE0gQSBDIEggSSBOIEUgPDw8ICovCgogICAgICBjb25zdCBXSURUSCA9IDQ4MCwgSEVJR0hUID0gNDgwOwoKICAgICAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2b3hlbHNjcmVlbicpOwogICAgICB2YXIgb2ZzY3IgPSAgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7CiAgICAgIHZhciBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTsKICAgICAgdmFyIG9mYyA9IG9mc2NyLmdldENvbnRleHQoJzJkJyk7CgogICAgICBjdHguaW1hZ2VTbW9vdGhpbmdFbmFibGVkID0gZmFsc2U7CiAgICAgIC8vY3R4LnNjYWxlKDIsIDIpOwoKICAgICAgb2ZzY3Iud2lkdGggPSBXSURUSDsKICAgICAgb2ZzY3IuaGVpZ2h0ID0gSEVJR0hUOwoKICAgICAgLyogZnVuY3Rpb24gZm9yIGRyYXdpbmcgNC1zaWRlZCBwb2x5Z29ucyAqLwoKICAgICAgZnVuY3Rpb24gZHJhd3BvbHkocDEsIHAyLCBwNCwgcDMsIGNvbG9yKSB7CiAgICAgICAgb2ZjLmZpbGxTdHlsZSA9IGNvbG9yOwogICAgICAgIG9mYy5iZWdpblBhdGgoKTsKICAgICAgICBvZmMubW92ZVRvKHAxLngsIHAxLnkpOwogICAgICAgIG9mYy5saW5lVG8ocDMueCwgcDMueSk7CiAgICAgICAgb2ZjLmxpbmVUbyhwNC54LCBwNC55KTsKICAgICAgICBvZmMubGluZVRvKHAyLngsIHAyLnkpOwogICAgICAgIG9mYy5jbG9zZVBhdGgoKTsKICAgICAgICBvZmMuZmlsbCgpOwogICAgICAgIG9mYy5iZWdpblBhdGgoKTsKICAgICAgICBvZmMubW92ZVRvKHAxLngsIHAxLnkpOwogICAgICAgIG9mYy5saW5lVG8ocDMueCwgcDMueSk7CiAgICAgICAgb2ZjLm1vdmVUbyhwMy54LCBwMy55KTsKICAgICAgICBvZmMubGluZVRvKHA0LngsIHA0LnkpOwogICAgICAgIG9mYy5tb3ZlVG8ocDQueCwgcDQueSk7CiAgICAgICAgb2ZjLmxpbmVUbyhwMi54LCBwMi55KTsKICAgICAgICBvZmMubW92ZVRvKHAyLngsIHAyLnkpOwogICAgICAgIG9mYy5saW5lVG8ocDEueCwgcDEueSk7CiAgICAgICAgb2ZjLmNsb3NlUGF0aCgpOwogICAgICAgIG9mYy5zdHJva2UoKTsKICAgICAgfQoKICAgICAgY2xhc3MgUG9pbnQyRCB7CgogICAgICAgIGNvbnN0cnVjdG9yKHgsIHkpIHsKCiAgICAgICAgICB0aGlzLnggPSB4OwogICAgICAgICAgdGhpcy55ID0geTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNsYXNzIFBvaW50M0QgewoKICAgICAgICBjb25zdHJ1Y3Rvcih4LCB5LCB6KSB7CgogICAgICAgICAgdGhpcy54ID0geDsKICAgICAgICAgIHRoaXMueSA9IHk7CiAgICAgICAgICB0aGlzLnogPSB6OwogICAgICAgIH0KICAgICAgfQoKICAgICAgY2xhc3MgUGxhaW4gewoKICAgICAgICBjb25zdHJ1Y3RvcihwMSwgcDIsIHAzLCBwNCwgY29sb3IsIHBvczEsIHBvczIpIHsKCiAgICAgICAgICB0aGlzLnAgPSBbcDEsIHAyLCBwMywgcDRdOwoKICAgICAgICAgIHRoaXMuY29sb3IgPSBjb2xvcjsKCiAgICAgICAgICB0aGlzLnBvczEgPSBwb3MxOwoKICAgICAgICAgIHRoaXMucG9zMiAgPSBwb3MyOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZnVuY3Rpb24gcm90YXRlKHgsIHksIGFuZ2xlKSB7CgogICAgICAgIHJldHVybiBbeCAqIGFuZ2xlLmNvcyAtIHkgKiBhbmdsZS5zaW4sIHggKiBhbmdsZS5zaW4gKyB5ICogYW5nbGUuY29zXTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gcm90YXRlM2QoeCwgeSwgeiwgbHIsIHVkKSB7CgogICAgICAgIFt4LCB6XSA9IHJvdGF0ZSh4LCB6LCBscik7CgogICAgICAgIFt5LCB6XSA9IHJvdGF0ZSh5LCB6LCB1ZCk7CgogICAgICAgIHJldHVybiBbeCwgeSwgel07CiAgICAgIH0KCiAgICAgIC8qCgogICAgICBuZXcgQ2FtZXJhKCA8TnVtYmVyID0gZmllbGQgb2Ygdmlldz4gKSByZXR1cm5zIENhbWVyYQoKICAgICAgQ2FtZXJhLnJvdGF0ZSggPE51bWJlciA9IGxlZnQtcmlnaHQgcm90YXRpb24+LCA8TnVtYmVyID0gdXAtZG93biByb3RhdGlvbj4gKSByZXR1cm5zIHZvaWQKCiAgICAgIENhbWVyYS5wcm9qZWN0KCA8UG9pbnQzRD4gKSByZXR1cm5zIFBvaW50MkQKCiAgICAgIENhbWVyYS5zZXRGb3YoIDxOdW1iZXIgPSBmaWVsZCBvZiB2aWV3PiApCgogICAgICAqLwoKICAgICAgY2xhc3MgQ2FtZXJhIHsKCiAgICAgICAgY29uc3RydWN0b3IoZm92LCBkaXN0KSB7CgogICAgICAgICAgdGhpcy5jc3ogPSAwLjYgLyA4OwogICAgICAgICAgdGhpcy50b3AgPSAwOwoKICAgICAgICAgIHRoaXMucm90TFIgPSB7dmFsOiAwLCBzaW46IDAsIGNvczogMX07CiAgICAgICAgICB0aGlzLnJvdFVEID0ge3ZhbDogMCwgc2luOiAwLCBjb3M6IDF9OwoKICAgICAgICAgIHRoaXMuZGlzdCA9IGRpc3Q7CiAgICAgICAgICB0aGlzLmZvdl9jdGcgPSAxIC8gTWF0aC50YW4oZm92ICogTWF0aC5QSSAvIDM2MCk7CiAgICAgICAgfQoKICAgICAgICByb3RhdGUoeHosIHl6KSB7CgogICAgICAgICAgdGhpcy5yb3RMUi52YWwgLT0geHo7CiAgICAgICAgICB0aGlzLnJvdFVELnZhbCAtPSB5ejsKCiAgICAgICAgICB0aGlzLnJvdExSLnNpbiA9IE1hdGguc2luKHRoaXMucm90TFIudmFsKTsKICAgICAgICAgIHRoaXMucm90TFIuY29zID0gTWF0aC5jb3ModGhpcy5yb3RMUi52YWwpOwogICAgICAgICAgdGhpcy5yb3RVRC5zaW4gPSBNYXRoLnNpbih0aGlzLnJvdFVELnZhbCk7CiAgICAgICAgICB0aGlzLnJvdFVELmNvcyA9IE1hdGguY29zKHRoaXMucm90VUQudmFsKTsKICAgICAgICB9CgogICAgICAgIHNldEZvdihmb3YpIHsKCiAgICAgICAgICB0aGlzLmZvdl9jdGcgPSAxIC8gTWF0aC50YW4oZm92ICogTWF0aC5QSSAvIDM2MCk7CiAgICAgICAgfQoKICAgICAgICBwcm9qZWN0KHAzZCkgewoKICAgICAgICAgIHZhciB4ID0gKHAzZC54IC0gOCkgKiB0aGlzLmNzejsKICAgICAgICAgIHZhciB5ID0gKHRoaXMudG9wIC0gcDNkLnkpICogdGhpcy5jc3o7CiAgICAgICAgICB2YXIgeiA9IChwM2QueiAtIDgpICogdGhpcy5jc3o7CgogICAgICAgICAgW3gsIHksIHpdID0gcm90YXRlM2QoeCwgeSwgeiwgdGhpcy5yb3RMUiwgdGhpcy5yb3RVRCk7CgogICAgICAgICAgeiArPSB0aGlzLmRpc3Q7CgogICAgICAgICAgdmFyIGQgPSB0aGlzLmZvdl9jdGcgLyB6OwoKICAgICAgICAgIHJldHVybiBuZXcgUG9pbnQyRChXSURUSCAqICgwLjUgKyB4ICogZCksIEhFSUdIVCAqICgwLjUgKyB5ICogZCkpOwogICAgICAgIH0KCiAgICAgICAgZ2V0RGlzdChwM2QpIHsKCiAgICAgICAgICB2YXIgeCA9IChwM2QueCAtIDgpICogdGhpcy5jc3o7CiAgICAgICAgICB2YXIgeSA9ICh0aGlzLnRvcCAtIHAzZC55KSAqIHRoaXMuY3N6OwogICAgICAgICAgdmFyIHogPSAocDNkLnogLSA4KSAqIHRoaXMuY3N6OwoKICAgICAgICAgIFt4LCB5LCB6XSA9IHJvdGF0ZTNkKHgsIHksIHosIHRoaXMucm90TFIsIHRoaXMucm90VUQpOwoKICAgICAgICAgIHogKz0gdGhpcy5kaXN0OwoKICAgICAgICAgIHJldHVybiB4ICogeCArIHkgKiB5ICsgeiAqIHo7CiAgICAgICAgfQogICAgICB9CiAgICA8L3NjcmlwdD4KICAgIDxzY3JpcHQgbmFtZT0ibWFpbiI+CiAgICAJLyogY29uc3RhbnRzICovCgogICAgICBjb25zdCBFTVBUWSA9ICgxIDw8IDE1KTsKCiAgICAgIC8qIGdldCBwb3NpdGlvbiBudW1iZXIgaW4gbWFwICovCgogICAgICBmdW5jdGlvbiBnZXRQb3MoeCwgeSwgeikgewoKICAgICAgICByZXR1cm4gKHggPDwgOCkgfCAoeSA8PCA0KSB8IHo7CiAgICAgIH0KCiAgICAgIC8qIGdldCBjb2xvciBudW1iZXIgKi8KCiAgICAgIGZ1bmN0aW9uIGdldENvbG9yKHMpIHsKCiAgICAgICAgcmV0dXJuIChOdW1iZXIoJzB4JyArIHMuc3Vic3RyKDEsIDIpKSA8PCAxNikgfCAoTnVtYmVyKCcweCcgKyBzLnN1YnN0cigzLCAyKSkgPDwgOCkgfCBOdW1iZXIoJzB4JyArIHMuc3Vic3RyKDUsIDIpKTsKICAgICAgfQoKICAgICAgLyogZ2V0IHNxdWFyZSBvZiBkaXN0YW5jZSBvZiBhIHNpZGUgb2Ygc3F1YXJlIGZyb20gY2FtZXJhICovCgogICAgICBmdW5jdGlvbiBkaXN0KGNhbSwgcGxpKSB7CgogICAgICAgIHZhciBtYSA9IDA7CgogICAgICAgIGZvcih2YXIgaSBpbiBwbGkucCkgewoKICAgICAgICAgIG1hID0gTWF0aC5tYXgobWEsIGNhbWVyYS5nZXREaXN0KHBsaS5wW2ldKSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbWE7CiAgICAgIH0KCiAgICAgIC8qIGNoZWNrIGlmIHBvaW50IGlzIGluc2lkZSBhIHBvbHlnb24gKi8KCiAgICAgIGZ1bmN0aW9uIGluc2lkZShwb2ludCwgcG9seSkgewoKICAgICAgICAgIHZhciB4ID0gcG9pbnQueCwgeSA9IHBvaW50Lnk7CgogICAgICAgICAgdmFyIHZzID0gcG9seS5wOwoKICAgICAgICAgIHZhciBpbnNpZGUgPSBmYWxzZTsKICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBqID0gdnMubGVuZ3RoIC0gMTsgaSA8IHZzLmxlbmd0aDsgaiA9IGkrKykgewogICAgICAgICAgICAgIHZhciB4aSA9IHZzW2ldLngsIHlpID0gdnNbaV0ueTsKICAgICAgICAgICAgICB2YXIgeGogPSB2c1tqXS54LCB5aiA9IHZzW2pdLnk7CgogICAgICAgICAgICAgIHZhciBpbnRlcnNlY3QgPSAoKHlpID4geSkgIT0gKHlqID4geSkpCiAgICAgICAgICAgICAgICAgICYmICh4IDwgKHhqIC0geGkpICogKHkgLSB5aSkgLyAoeWogLSB5aSkgKyB4aSk7CiAgICAgICAgICAgICAgaWYgKGludGVyc2VjdCkgaW5zaWRlID0gIWluc2lkZTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gaW5zaWRlOwogICAgICB9OwoKICAgICAgdmFyIGNhbWVyYSA9IG5ldyBDYW1lcmEoOTAsIDIpOyAvLyBDYW1lcmEgb2JqZWN0CgogICAgICBjYW1lcmEucm90YXRlKC1NYXRoLlBJICogMC4yNSwgLU1hdGguUEkgKiAwLjI1KTsKCiAgICAgIC8qIG1hcCBmb3IgdGVzdGluZywgdGhpcyBwYXJ0IG9mIGNvZGUgd2lsbCBsYXRlciBiZSByZXBsYWNlZCAqLwoKICAgICAgdmFyIG1hcCA9IG5ldyBVaW50MzJBcnJheSg0MDk2KTsKCiAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCAzMjc2ODsgaSsrKSBtYXBbaV0gPSBFTVBUWTsKCiAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCAxNjsgaSsrKSBmb3IodmFyIGogPSAwOyBqIDwgMTY7IGorKykgbWFwW2dldFBvcyhpLCAwLCBqKV0gPSAyNTUgPDwgODsKCiAgICAgIC8qIHJlbmRlciAqLwoKICAgICAgdmFyIHBsYWluczNEID0gW10sIHByb2plY3Rpb25zID0gW107CgogICAgICAvKiBjaGVjayBpZiBwbGFjZSBpbiB0aGUgbWFwIGlzIGVtcHR5ICovCgogICAgICBmdW5jdGlvbiBpc0VtcHR5KHgsIHksIHopIHsKCiAgICAgICAgcmV0dXJuIHggPCAwIHx8IHkgPCAwIHx8IHogPCAwIHx8IHggPiAxNSB8fCB5ID4gMTUgfHwgeiA+IDE1IHx8IG1hcFtnZXRQb3MoeCwgeSwgeildID09IEVNUFRZOwogICAgICB9CgogICAgICAvKiBsZWZ0IHBhZCAqLwoKICAgICAgU3RyaW5nLnByb3RvdHlwZS5scGFkID0gZnVuY3Rpb24obiwgYykgewoKICAgICAgICBzID0gJyc7CgogICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBNYXRoLm1heChuIC0gdGhpcy5sZW5ndGgsIDApOyBpKyspIHsKCiAgICAgICAgICBzICs9ICcwJzsKICAgICAgICB9CgogICAgICAgIHJldHVybiBzICsgdGhpczsKICAgICAgfQoKICAgICAgLyogZnVuY3Rpb24gZm9yIGxvYWRpbmcgYSAzYm0gKGJpdG1hcCBmb3JtYXQgZm9yIDkzRCApICovCgogICAgICBmdW5jdGlvbiBsb2FkTWFwKG1hcCkgewoKICAgICAgICBwbGFpbnMzRCA9IFtdOwoKICAgICAgICBmb3IodmFyIHggPSAwOyB4IDwgMTY7IHgrKykgewogICAgICAgICAgZm9yKHZhciB5ID0gMDsgeSA8IDE2OyB5KyspIHsKICAgICAgICAgICAgZm9yKHZhciB6ID0gMDsgeiA8IDE2OyB6KyspIHsKICAgICAgICAgICAgICBpZihtYXBbZ2V0UG9zKHgsIHksIHopXSAhPSBFTVBUWSkgewoKICAgICAgICAgICAgICAgIHZhciBjb2xvciA9ICcjJyArICgobWFwW2dldFBvcyh4LCB5LCB6KV0gPj4gMTYpICYgMjU1KS50b1N0cmluZygxNikubHBhZCgyLCAnMCcpICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICgobWFwW2dldFBvcyh4LCB5LCB6KV0gPj4gOCkgJiAyNTUpLnRvU3RyaW5nKDE2KS5scGFkKDIsICcwJykgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKG1hcFtnZXRQb3MoeCwgeSwgeildICYgMjU1KS50b1N0cmluZygxNikubHBhZCgyLCAnMCcpOwoKICAgICAgICAgICAgICAgIGlmKGlzRW1wdHkoeCArIDEsIHksIHopKSBwbGFpbnMzRC5wdXNoKG5ldyBQbGFpbigKCiAgICAgICAgICAgICAgICAgIG5ldyBQb2ludDNEKHggKyAxLCB5ICsgMSwgeiArIDEpLAogICAgICAgICAgICAgICAgICBuZXcgUG9pbnQzRCh4ICsgMSwgeSArIDEsIHopLAogICAgICAgICAgICAgICAgICBuZXcgUG9pbnQzRCh4ICsgMSwgeSwgeiksCiAgICAgICAgICAgICAgICAgIG5ldyBQb2ludDNEKHggKyAxLCB5LCB6ICsgMSksCgogICAgICAgICAgICAgICAgICBjb2xvciwgbmV3IFBvaW50M0QoeCwgeSwgeiksIG5ldyBQb2ludDNEKHggKyAxLCB5LCB6KQogICAgICAgICAgICAgICAgKSk7CiAgICAgICAgICAgICAgICBpZihpc0VtcHR5KHgsIHkgLSAxLCB6KSkgcGxhaW5zM0QucHVzaChuZXcgUGxhaW4oCgogICAgICAgICAgICAgICAgICBuZXcgUG9pbnQzRCh4LCB5LCB6KSwKICAgICAgICAgICAgICAgICAgbmV3IFBvaW50M0QoeCwgeSwgeiArIDEpLAogICAgICAgICAgICAgICAgICBuZXcgUG9pbnQzRCh4ICsgMSwgeSwgeiArIDEpLAogICAgICAgICAgICAgICAgICBuZXcgUG9pbnQzRCh4ICsgMSwgeSwgeiksCgogICAgICAgICAgICAgICAgICBjb2xvciwgbmV3IFBvaW50M0QoeCwgeSwgeiksIG5ldyBQb2ludDNEKHgsIHkgLSAxLCB6KQogICAgICAgICAgICAgICAgKSk7CiAgICAgICAgICAgICAgICBpZihpc0VtcHR5KHgsIHksIHogKyAxKSkgcGxhaW5zM0QucHVzaChuZXcgUGxhaW4oCgogICAgICAgICAgICAgICAgICBuZXcgUG9pbnQzRCh4LCB5ICsgMSwgeiArIDEpLAogICAgICAgICAgICAgICAgICBuZXcgUG9pbnQzRCh4ICsgMSwgeSArIDEsIHogKyAxKSwKICAgICAgICAgICAgICAgICAgbmV3IFBvaW50M0QoeCArIDEsIHksIHogKyAxKSwKICAgICAgICAgICAgICAgICAgbmV3IFBvaW50M0QoeCwgeSwgeiArIDEpLAoKICAgICAgICAgICAgICAgICAgY29sb3IsIG5ldyBQb2ludDNEKHgsIHksIHopLCBuZXcgUG9pbnQzRCh4LCB5LCB6ICsgMSkKICAgICAgICAgICAgICAgICkpOwogICAgICAgICAgICAgICAgaWYoaXNFbXB0eSh4IC0gMSwgeSwgeikpIHBsYWluczNELnB1c2gobmV3IFBsYWluKAoKICAgICAgICAgICAgICAgICAgbmV3IFBvaW50M0QoeCwgeSwgeiksCiAgICAgICAgICAgICAgICAgIG5ldyBQb2ludDNEKHgsIHksIHogKyAxKSwKICAgICAgICAgICAgICAgICAgbmV3IFBvaW50M0QoeCwgeSArIDEsIHogKyAxKSwKICAgICAgICAgICAgICAgICAgbmV3IFBvaW50M0QoeCwgeSArIDEsIHopLAoKICAgICAgICAgICAgICAgICAgY29sb3IsIG5ldyBQb2ludDNEKHgsIHksIHopLCBuZXcgUG9pbnQzRCh4IC0gMSwgeSwgeikKICAgICAgICAgICAgICAgICkpOwogICAgICAgICAgICAgICAgaWYoaXNFbXB0eSh4LCB5ICsgMSwgeikpIHBsYWluczNELnB1c2gobmV3IFBsYWluKAoKICAgICAgICAgICAgICAgICAgbmV3IFBvaW50M0QoeCwgeSArIDEsIHopLAogICAgICAgICAgICAgICAgICBuZXcgUG9pbnQzRCh4ICsgMSwgeSArIDEsIHopLAogICAgICAgICAgICAgICAgICBuZXcgUG9pbnQzRCh4ICsgMSwgeSArIDEsIHogKyAxKSwKICAgICAgICAgICAgICAgICAgbmV3IFBvaW50M0QoeCwgeSArIDEsIHogKyAxKSwKCiAgICAgICAgICAgICAgICAgIGNvbG9yLCBuZXcgUG9pbnQzRCh4LCB5LCB6KSwgbmV3IFBvaW50M0QoeCwgeSArIDEsIHopCiAgICAgICAgICAgICAgICApKTsKICAgICAgICAgICAgICAgIGlmKGlzRW1wdHkoeCwgeSwgeiAtIDEpKSBwbGFpbnMzRC5wdXNoKG5ldyBQbGFpbigKCiAgICAgICAgICAgICAgICAgIG5ldyBQb2ludDNEKHgsIHksIHopLAogICAgICAgICAgICAgICAgICBuZXcgUG9pbnQzRCh4ICsgMSwgeSwgeiksCiAgICAgICAgICAgICAgICAgIG5ldyBQb2ludDNEKHggKyAxLCB5ICsgMSwgeiksCiAgICAgICAgICAgICAgICAgIG5ldyBQb2ludDNEKHgsIHkgKyAxLCB6KSwKCiAgICAgICAgICAgICAgICAgIGNvbG9yLCBuZXcgUG9pbnQzRCh4LCB5LCB6KSwgbmV3IFBvaW50M0QoeCwgeSwgeiAtIDEpCiAgICAgICAgICAgICAgICApKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGN0eC5maWxsU3R5bGUgPSAnIzE5MTk3MCc7CgogICAgICAvKiBmdW5jdGlvbiBmb3IgcmVuZGVyaW5nIHNjcmVlbiAqLwoKICAgICAgZnVuY3Rpb24gcmVuZGVyKCkgewoKICAgICAgICBwcm9qZWN0aW9ucyA9IFtdOwoKICAgICAgICBjdHguY2xlYXJSZWN0KDAsIDAsIFdJRFRILCBIRUlHSFQpOwogICAgICAgIG9mYy5jbGVhclJlY3QoMCwgMCwgV0lEVEgsIEhFSUdIVCk7CgogICAgICAgIHBsYWluczNELnNvcnQoKGEsIGIpID0+IGRpc3QoY2FtZXJhLCBiKSAtIGRpc3QoY2FtZXJhLCBhKSk7CgogICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBwbGFpbnMzRC5sZW5ndGg7IGkrKykgewoKICAgICAgICAgIGRyYXdwb2x5KC4uLnBsYWluczNEW2ldLnAubWFwKHggPT4gY2FtZXJhLnByb2plY3QoeCkpLCBwbGFpbnMzRFtpXS5jb2xvcik7CgogICAgICAgICAgcHJvamVjdGlvbnMucHVzaChuZXcgUGxhaW4oLi4ucGxhaW5zM0RbaV0ucC5tYXAoeCA9PiBjYW1lcmEucHJvamVjdCh4KSksIGRpc3QoY2FtZXJhLCBwbGFpbnMzRFtpXSksIHBsYWluczNEW2ldLnBvczEsIHBsYWluczNEW2ldLnBvczIpKTsKICAgICAgICB9CgogICAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCBXSURUSCwgSEVJR0hUKTsKCiAgICAgICAgY3R4LmRyYXdJbWFnZShvZnNjciwgMCwgMCk7CiAgICAgIH0KCiAgICAgIHZhciB0aWxlX2NvbG9yM2QgPSAyNTU7IC8vIGNvbG9yIG9mIHRpbGVzIHRvIGJlIHBsYWNlZAoKICAgICAgdmFyIGtleSA9IHt9OwogICAgICB2YXIgbW91c2UgPSB7bGVmdDogZmFsc2UsIHJpZ2h0OiBmYWxzZSwgeDogMCwgeTogMCwgY291bnQ6IDB9OwoKICAgICAgdmFyIHVwZGF0ZTNEQiA9IGZ1bmN0aW9uKCkgewoKICAgICAgICAvKiByb3RhdGlvbiBzdHVmZiAqLwoKICAgICAgICBpZihrZXlbODddKSBjYW1lcmEucm90YXRlKDAsIC1NYXRoLlBJIC8gOTApOwogICAgICAgIGlmKGtleVs4M10pIGNhbWVyYS5yb3RhdGUoMCwgTWF0aC5QSSAvIDkwKTsKICAgICAgICBpZihrZXlbNjhdKSBjYW1lcmEucm90YXRlKC1NYXRoLlBJIC8gOTAsIDApOwogICAgICAgIGlmKGtleVs2NV0pIGNhbWVyYS5yb3RhdGUoTWF0aC5QSSAvIDkwLCAwKTsKCiAgICAgICAgLyogbW91c2Ugc3R1ZmYgKi8KCiAgICAgICAgaWYoKG1vdXNlLmxlZnQgfHwgbW91c2UucmlnaHQpICYmICFtb3VzZS5jb3VudCkgewoKICAgICAgICAgIHZhciBwb3MxID0gLTEsIHBvczIgPSAtMSwgZGkgPSAxZTk7IC8vIHBvczEgPSBwb3NpdGlvbiBvZiBjdXJyZW50IGJsb2NrLCBwb3MyID0gcG9zaXRpb24gb2YgYmxvY2sgdGhpcyBzaWRlIGlzIGZhY2luZyB0b3dhcmRzCgogICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHByb2plY3Rpb25zLmxlbmd0aDsgaSsrKSB7CgogICAgICAgICAgICBpZihpbnNpZGUobW91c2UsIHByb2plY3Rpb25zW2ldKSAmJiBwcm9qZWN0aW9uc1tpXS5jb2xvciA8IGRpKSB7CgogICAgICAgICAgICAgIGRpID0gcHJvamVjdGlvbnNbaV0uY29sb3I7IC8vIGNvbG9yIGFjdHMgYXMgZGlzdGFuY2UgaGVyZSAoZG9uJ3QgYXNrIHdoeSwgdGhlcmUncyBubyBnb29kIGFuc3dlcikKCiAgICAgICAgICAgICAgcG9zMSA9IHByb2plY3Rpb25zW2ldLnBvczE7CiAgICAgICAgICAgICAgcG9zMiA9IHByb2plY3Rpb25zW2ldLnBvczI7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZihwb3MxICE9IC0xKSB7CgogICAgICAgICAgICBpZihtb3VzZS5sZWZ0KSBtYXBbZ2V0UG9zKHBvczIueCwgcG9zMi55LCBwb3MyLnopXSA9IHRpbGVfY29sb3IzZDsKICAgICAgICAgICAgaWYobW91c2UucmlnaHQpIG1hcFtnZXRQb3MocG9zMS54LCBwb3MxLnksIHBvczEueildID0gRU1QVFk7CgogICAgICAgICAgICBtb3VzZS5jb3VudCA9IDEwOyAvLyBtb3VzZSBjb3VudCBwcmV2ZW50cyB1bmludGVudGlvbmFsIGFjdGlvbnMgYnkgZGlzYWJsaW5nIHBsYWNpbmcgYW5kIGRlc3Ryb3lpbmcgZm9yIDUwIG1zCgogICAgICAgICAgICBsb2FkTWFwKG1hcCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZihtb3VzZS5jb3VudCkgbW91c2UuY291bnQtLTsKCiAgICAgICAgcmVuZGVyKCk7CiAgICAgIH0KCiAgICAgIHZhciBjYnI7CgogICAgICAvKiBldmVudCBsaXN0ZW5lcnMgKi8KICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGUgPT4ga2V5W2Uua2V5Q29kZV0gPSB0cnVlKTsKICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCAgZSA9PiBrZXlbZS5rZXlDb2RlXSA9IGZhbHNlKTsKICAgICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBlID0+IHsKICAgICAgICBpZighZS5idXR0b24pIG1vdXNlLmxlZnQgPSBmYWxzZTsKICAgICAgICBlbHNlIG1vdXNlLnJpZ2h0ID0gZmFsc2U7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9KTsKICAgICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGUgPT4gewogICAgICAgIGlmKG1vdXNlLnggPCBjYnIubGVmdCB8fCBtb3VzZS54ID4gY2JyLnJpZ2h0IHx8IG1vdXNlLnkgPCBjYnIudG9wIHx8IG1vdXNlLnkgPiBjYnIuYm90dG9tKSByZXR1cm47CiAgICAgICAgaWYoIWUuYnV0dG9uKSBtb3VzZS5sZWZ0ID0gdHJ1ZTsKICAgICAgICBlbHNlIG1vdXNlLnJpZ2h0ID0gdHJ1ZTsKICAgICAgfSk7CiAgICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBlID0+IHsKCiAgICAgICAgY2JyID0gY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOyAvLyBmb3IgbW91c2UgbG9jYXRpb24KICAgICAgICBtb3VzZS54ID0gZS5wYWdlWCAtIGNici5sZWZ0OwogICAgICAgIG1vdXNlLnkgPSBlLnBhZ2VZIC0gY2JyLnRvcDsKICAgICAgfSk7CiAgICAgIGNhbnZhcy5vbmNvbnRleHRtZW51ID0gZSA9PiBmYWxzZTsgLy8gY2F1c2UgcmlnaHQgY2xpY2sgaXMgdXNlZCBmb3IgZGVzdHJveWluZyBibG9ja3MKCgogICAgICAvKgoKICAgICAgRVhQT1JUUzoKCiAgICAgIC0gdXBkYXRlM0RCKCksIHVzZSBpdCBpbiBzZXRJbnRlcnZhbAogICAgICAtIGNhbWVyYS5zZXRGb3YoYW5nbGUpCiAgICAgIC0gY2FtZXJhLmRpc3QgPSBkaXN0YW5jZSBmcm9tIG1vZGVsCiAgICAgIC0gY2FtZXJhLnRvcCA9IHktcG9zaXRpb24gb2YgdGhlIGxvd2VzdCBsYXllciBvZiBtYXAKICAgICAgLSBsb2FkTWFwKFVpbnQzMkFycmF5KSA9IGxvYWQgYSBtYXAgaW50byB0aGUgZWRpdG9yCiAgICAgIC0gdGlsZV9jb2xvcjNkIC0gYSBudW1iZXIgcmVwcmVzZW50aW5nIGN1cnJlbnQgZmlsbCBjb2xvcgogICAgICAtIGdldENvbG9yKGh0bWwgY29sb3IgY29kZSkgLSByZXR1cm5zIGEgbnVtYmVyIHByZXNlbnRpbmcgZ2l2ZW4gY29sb3IKCiAgICAgIElNUE9SVEFOVDoKCiAgICAgIC0gd2hlbiBwcm9ncmFtIGxvYWRzLCBpdCBmaW5kcyBhIGNhbnZhcyBlbGVtZW50IHdpdGggaWQgPSAidm94ZWxzY3JlZW4iLAogICAgICAgIG1ha2Ugc3VyZSB0byBoYXZlIHRoYXQgZWxlbWVudCBzb21ld2hlcmUgYmVmb3JlIHJ1bm5pbmcgcHJvZ3JhbQoKICAgICAgKi8KCiAgICA8L3NjcmlwdD4KICAgIDxzY3JpcHQgbmFtZT0iYXBwIj4KICAgICAgc2V0SW50ZXJ2YWwodXBkYXRlM0RCLCAxMCk7CiAgICAgIGxvYWRNYXAobWFwKTsKICAgICAgCiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkaXN0Jykub25pbnB1dCA9IGZ1bmN0aW9uKGUpIHsKCiAgICAgICAgY2FtZXJhLmRpc3QgPSBOdW1iZXIoZS50YXJnZXQudmFsdWUpOwogICAgICB9CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd5cG9zJykub25pbnB1dCA9IGZ1bmN0aW9uKGUpIHsKCiAgICAgICAgY2FtZXJhLnRvcCA9IE51bWJlcihlLnRhcmdldC52YWx1ZSk7CiAgICAgIH0KCiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzYXZlJykub25jbGljayA9IGZ1bmN0aW9uKCkgewogICAgICAJcGFyZW50LiRwcm9tcHQoIkVudGVyIGRlc2lyZWQgZmlsZW5hbWUsIHRoZW4gc2VsZWN0IGZvbGRlciB3aGVyZSB5b3Ugd2FudCBpdCBzYXZlZC4iLCBmdW5jdGlvbihhLCBmbmFtZSkgewogICAgICAJICBpZighYSkgcmV0dXJuOwogICAgICAgICAgcGFyZW50LiRleHBsb3JlcignYS9ldGMvM0RCdWlsZGVyL21vZGVscy8nLCB7YnJvd3NlOiB0cnVlLCBleHBsb3JlcjogdHJ1ZSwgb25jbG9zZTogZnVuY3Rpb24ob2ssIGZpbGUpIHsKICAgICAgICAgICAgaWYgKG9rKSB7CiAgICAgICAgICAgICAgdmFyIHJkID0gJyc7CiAgICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IDQwOTY7IGkrKykgcmQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSgobWFwW2ldID4+IDI0KSAmIDI1NSkgKyAgU3RyaW5nLmZyb21DaGFyQ29kZSgobWFwW2ldID4+IDE2KSAmIDI1NSkgKyAgU3RyaW5nLmZyb21DaGFyQ29kZSgobWFwW2ldID4+IDgpICYgMjU1KSArICBTdHJpbmcuZnJvbUNoYXJDb2RlKChtYXBbaV0pICYgMjU1KTsKICAgICAgICAgICAgICBwYXJlbnQuJGRiLnNldCgoZmlsZSArIGZuYW1lKS5zcGxpdCgnLycpLnNsaWNlKDEpLmZpbHRlcih4ID0+IHghPScnKS5qb2luKCcvJyksIHJkKTsKICAgICAgICAgICAgICBzZXRUaW1lb3V0KHBhcmVudC4kZXhwbG9yZXIucmVmcmVzaCwgNTAwKTsKICAgICAgICAgICAgfQogICAgICAgICAgfX0pOwogICAgICAgIH0pOwogICAgICB9CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcGVuJykub25jbGljayA9IGZ1bmN0aW9uKCkgewogICAgICAJcGFyZW50LiRleHBsb3JlcignYS9ldGMvM0RCdWlsZGVyL21vZGVscy8nLCB7YnJvd3NlOiB0cnVlLCBleHBsb3JlcjogdHJ1ZSwgb25jbG9zZTogZnVuY3Rpb24ob2ssIGZpbGUpIHsKCQkgIGlmIChvaykgewogICAgCQlwYXJlbnQuJGRiLmdldFJhdyhmaWxlLnNsaWNlKDMpLCBhc3luYyBmdW5jdGlvbihhLCByZCkgewogICAgICAJCQlmb3IodmFyIGkgPSAwOyBpIDwgNDA5NjsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICBtYXBbaV0gPSAocmQuY2hhckF0KGkgKiA0KSA8PCAyNCkgfCAocmQuY2hhckNvZGVBdChpICogNCArIDEpIDw8IDE2KSAgfCAocmQuY2hhckNvZGVBdChpICogNCArIDIpIDw8IDgpICB8IHJkLmNoYXJDb2RlQXQoaSAqIDQgKyAzKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGxvYWRNYXAobWFwKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgCQl9KTsKICAJCSAgfQoJCX19KTsKICAgICAgfQogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGxhaW4nKS5vbmNsaWNrID0gZnVuY3Rpb24oKSB7CiAgICAgIAogICAgICAJICBmb3IodmFyIGkgPSAwOyBpIDwgMzI3Njg7IGkrKykgbWFwW2ldID0gRU1QVFk7CgkgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgMTY7IGkrKykgZm9yKHZhciBqID0gMDsgaiA8IDE2OyBqKyspIG1hcFtnZXRQb3MoaSwgMCwgaildID0gMjU1IDw8IDg7CiAgICAgICAgICBsb2FkTWFwKG1hcCk7CiAgICAgIH0KICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZvaWQnKS5vbmNsaWNrID0gZnVuY3Rpb24oKSB7CiAgICAgIAogICAgICAJICBmb3IodmFyIGkgPSAwOyBpIDwgMzI3Njg7IGkrKykgbWFwW2ldID0gRU1QVFk7CgkgICAgICBmb3IodmFyIGkgPSA4OyBpIDwgMTA7IGkrKykgZm9yKHZhciBqID0gODsgaiA8IDEwOyBqKyspIG1hcFtnZXRQb3MoaSwgMCwgaildID0gMjU1IDw8IDg7CiAgICAgICAgICBsb2FkTWFwKG1hcCk7CiAgICAgIH0KICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlbHAnKS5vbmNsaWNrID0gXz0+cGFyZW50LiRhbGVydCgiSGVscCBwYWdlOiBodHRwczovL2dpdGh1Yi5jb20vd2luZG93czkzLWNvbW11bml0eS9CdWlsZDNEL2Jsb2IvbWFzdGVyL2hlbHAubWQiKTsKICAgIDwvc2NyaXB0PgogIDwvYm9keT4KPC9odG1sPgo=";
var application_init = "bGUuX2FwcHNbIkJ1aWxkM0QiXSA9IHsKICBuYW1lOiAiM0RCdWlsZGVyIiwKICBjYXRoZWdvcmllczogIkdyYXBoaWNzIiwKICBpY29uOiAiL2MvZmlsZXMvaW1hZ2VzL2ljb25zL2JvbWIucG5nIiwKICBleGVjOiAoKT0+ICRleGUoImlmcmFtZSAvYS9ldGMvM0RCdWlsZGVyL2FwcC5odG1sIC0td2lkdGg9NDg0IC0tLWhlaWdodD02NDAgLS1pY29uPS9jL2ZpbGVzL2ltYWdlcy9pY29ucy9ib21iLnBuZyIpCn0=";

/* create files and folders */

$db.set("etc/3DBuilder/models/README.txt", "You can save your models here.");
$db.set("etc/3DBuilder/app.html", atob(application_base64));
$db.set("boot/Build3D_init.js", atob(application_init));
localStorage.setItem('desktop/Build3D.lnk42', '{"exe":"Build3D"}');

$alert("Press OK to restart.", function() {$exe("reboot")})
